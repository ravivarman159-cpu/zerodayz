<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ZeroDAYZ Job Portal</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<style>
body { margin:0; font-family:Arial,sans-serif; background: url('https://images.unsplash.com/photo-1503676260728-1c00da094a0b?auto=format&fit=crop&w=1350&q=80') no-repeat center center fixed; background-size: cover; }
header { background: rgba(76,175,80,0.85); color:white; text-align:center; padding:20px; font-size:30px; font-weight:bold; animation:fadeIn 2s;}
.container { display:flex; flex-wrap:wrap; justify-content:center; padding:20px; gap:20px; }
form { background: rgba(255,255,255,0.95); padding:20px; border-radius:15px; width:350px; box-shadow:0 4px 15px rgba(0,0,0,0.3); animation:slideIn 1s; }
form h3 { color:#4CAF50; margin-top:0;}
label{display:block;margin-top:10px;font-weight:bold;}
input, select, textarea, button{width:100%;padding:8px;margin-top:5px;border-radius:6px;border:1px solid #ccc;}
button{background:#4CAF50;color:white;border:none;cursor:pointer;margin-top:15px;font-size:16px;}
button:hover{background:#45a049;}
#map{height:500px;width:90%;max-width:800px;margin:20px auto;border-radius:15px;box-shadow:0 4px 15px rgba(0,0,0,0.3);}
#output{margin-top:20px;padding:10px;background:#e8f5e9;border-left:4px solid #43a047;border-radius:8px;display:none;}
@keyframes fadeIn {from{opacity:0;} to{opacity:1;}}
@keyframes slideIn {from{transform:translateY(-50px);opacity:0;} to{transform:translateY(0);opacity:1;}}
</style>
</head>
<body>
<header>ZeroDAYZ Job Portal</header>

<div class="container">
<!-- Admin Add Job -->
<form id="vacancyForm">
<h3>Add Job Vacancy</h3>
<label>Title:</label><input type="text" id="title" required/>
<label>Area/City:</label><input type="text" id="area" required/>
<label>Address:</label><input type="text" id="addressAdmin" required/>
<label>Work Time:</label><select id="time"><option>Full-Time</option><option>Part-Time</option><option>Night-Time</option></select>
<label>Vacancies:</label><input type="number" id="vacancies" required/>
<label>Latitude:</label><input type="number" id="lat" step="any" required/>
<label>Longitude:</label><input type="number" id="lng" step="any" required/>
<button type="submit">Add Job</button>
</form>

<!-- Applicant Form -->
<form id="jobForm">
<h3>Apply for a Job</h3>
<label>Full Name:</label><input type="text" id="name"/>
<label>Position:</label><select id="position"><option>Home Nurse</option><option>Support Worker</option><option>Care Assistant</option></select>
<label>Work Time:</label>
<div>
<input type="radio" name="worktime" value="Full-Time">Full-Time
<input type="radio" name="worktime" value="Part-Time">Part-Time
<input type="radio" name="worktime" value="Night-Time">Night-Time
</div>
<label>Why are you applying?</label><textarea id="message"></textarea>
<button type="submit">Submit Application</button>
</form>
</div>

<div id="map"></div>
<div id="output"></div>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
  // Firebase Config
 const firebaseConfig = {
  apiKey: "AIzaSyC4wcIagcPYJr76tEczcjvFNJYiEBqoNKE",
  authDomain: "zerodayz-8564a.firebaseapp.com",
  projectId: "zerodayz-8564a",
  storageBucket: "zerodayz-8564a.firebasestorage.app",
  messagingSenderId: "462027652887",
  appId: "1:462027652887:web:a857d0b39101e80826c152",
  measurementId: "G-FZT3F6C1HB"
};
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // Initialize Map
  const map = L.map('map').setView([11.0168,76.9558],12);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'&copy; OpenStreetMap contributors'}).addTo(map);

  // Add Job Vacancy
  document.getElementById("vacancyForm").addEventListener("submit", async e => {
    e.preventDefault();
    const jobData = {
      title: document.getElementById("title").value,
      area: document.getElementById("area").value,
      address: document.getElementById("addressAdmin").value,
      time: document.getElementById("time").value,
      vacancies: parseInt(document.getElementById("vacancies").value),
      location: {
        lat: parseFloat(document.getElementById("lat").value),
        lng: parseFloat(document.getElementById("lng").value)
      }
    };
    await db.collection("jobs").add(jobData);
    alert("Job Added!");
    e.target.reset();
    loadJobs();
  });

  // Applicant Form
  document.getElementById("jobForm").addEventListener("submit", async e => {
    e.preventDefault();
    const appData = {
      name: document.getElementById("name").value,
      position: document.getElementById("position").value,
      worktime: document.querySelector('input[name="worktime"]:checked')?.value,
      message: document.getElementById("message").value
    };
    await db.collection("applications").add(appData);
    alert("Application Submitted!");
    e.target.reset();
    loadJobs();
  });

  // Load Jobs
  async function loadJobs(){
    const output=document.getElementById("output");
    output.style.display="block";
    const snapshot = await db.collection("jobs").get();
    let html = "<h3>Available Jobs</h3>";
    snapshot.forEach(doc => {
      const job = doc.data();
      html += `<p><strong>${job.title}</strong> (${job.time})<br/>Vacancies: ${job.vacancies}<br/>Location: (${job.location.lat},${job.location.lng})</p>`;
      L.marker([job.location.lat,job.location.lng]).addTo(map).bindPopup(`<b>${job.title}</b><br>Vacancies: ${job.vacancies}`);
    });
    output.innerHTML = html;
  }

  loadJobs();
</script>

</body>
</html>
